
script(type="text/javascript").
    var pugDataJobList = !{JSON.stringify(jobList)};

    function onJobClicked(jobIdx) {
        socket.emit('OpenJob', {jobName: pugDataJobList[jobIdx].name, jobId: pugDataJobList[jobIdx].id});
    }

    function onAddJobClicked() {
        socket.emit('AddJob', {jobName: $('input.newJobName').val()});
    }

    function onRenameJobClicked(jobIndex) {
        var jobName = $('a#jobName' + jobIndex)[0].innerHTML;

        $('a#jobName' + jobIndex).hide();
        $('div#normal' + jobIndex).hide();

        $('input#input' + jobIndex).show();
        $('div#rename' + jobIndex).show();

        $('input#input' + jobIndex).val(jobName);
    }

    function onRemoveJobClicked(jobIdx) {
        if (confirm("删除是不可恢复的，你确认要删除 " + pugDataJobList[jobIdx].name + " 吗？")) {
            socket.emit('RemoveJob', {jobName: pugDataJobList[jobIdx].name, jobId: pugDataJobList[jobIdx].id});
        }
    }

    function onRenameJobOKClicked(jobIndex) {
        var jobName = $('a#jobName' + jobIndex)[0].innerHTML;
        var newName = $('input#input' + jobIndex).val();
        if (newName.length == 0) {
            alert('请输入新名字');
            return;
        }

        $('a#jobName' + jobIndex).show();
        $('div#normal' + jobIndex).show();

        $('input#input' + jobIndex).hide();
        $('div#rename' + jobIndex).hide();

        socket.emit('RenameJob', {jobName: jobName, newJobName: newName});
    }

    function onRenameJobCancelClicked(jobIndex) {
        $('a#jobName' + jobIndex).show();
        $('div#normal' + jobIndex).show();

        $('input#input' + jobIndex).hide();
        $('div#rename' + jobIndex).hide();    
    }
div
    //- ul(style="list-style-type:none;")
    table(border='1', align='center')
        tr
            td(align='center') job名
            td
        - for (var i = 0; i < jobList.length; ++i)
            tr
                td(style='width:110px', align='center')
                    a(id='jobName' + i, href="javascript:void(0)", onclick='onJobClicked(' + i + ')') #{jobList[i].name}
                    input(id='input' + i, type='text', style='width:100px; display:none')
                td
                    div(id='normal' + i)
                        a(href="javascript:void(0)", onclick="onRenameJobClicked(" + i + ")") 改名
                        br
                        a(href="javascript:void(0)", onclick="onRemoveJobClicked(" + i + ")") 删除
                    div(id='rename' + i, style='display:none')
                        a(href="javascript:void(0)", onclick="onRenameJobOKClicked(" + i + ")") 确定
                        br
                        a(href="javascript:void(0)", onclick="onRenameJobCancelClicked(" + i + ")") 取消                        


    br
    br
    table
        tr
            td
                input.newJobName(type='text', style='width:100px')
            td
                a(href='javascript:void(0)', onclick='onAddJobClicked()') 新建